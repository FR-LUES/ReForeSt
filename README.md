# ReForeSt - remote sensing of forest management and structural diversity

![lidar_spin_final](https://github.com/user-attachments/assets/a30a580e-f2da-48ed-94dd-f7f1f4d2e771)

## Introduction          
The aim of this DEFRA funded project is to link LiDAR derived structural metrics to forest biodiversity and in turn use LiDAR to explore how management interventions can enhance forest structure. The project is led by Forest Research (FR) in collaboration with the Environment Agency (EA) and the Sylva foundation. The LiDAR data used by the project was collected by the EAs England national LiDAR programme (NLP), as such all study sites are limited to England. The project comprises three seperate work packages (WPs): the first explores how LiDAR derived forest structure metrics can supplement/enhance/replace field derived metrics when explaining patterns of biodiversity, these metrics are then scaled to the national level; the second looks at LiDAR derived structural metrics through time as forests undergo different management interventions; and the third pilots the use of synthetic canopy height models (sCHMs), derived from aerial imagery, for measuring forest structural attributes. These three work packages are labelled WP3-WP5 as this is part of a wider project, not all of which is included in this repo. Below we described each work package in detail and we also link to more in depth descriptions of the code. General information about our code structure is provided in Box 1.

> **_BOX 1: Code structure_**
Each work package has its own set of scripts and these can all be found in the code folder. However, inputs and outputs for these scripts are stored together as they may overlap between work packages. We use a standard scripting pipeline for each work package where scripts 0 and 1 are setup and function scripts respectively. The setup script defines things like constants and file paths where the function script defines...functions. These two scripts MUST be run first for any of the following worker scripts to work. The worker scripts are also numbered and generally should be run sequentially, however you may be able to get away with running scripts in isolation as long as the setup and function scripts have been run. 

## WP3:
[WP3 Code description](https://github.com/FR-LUES/ReForeSt/blob/main/WP3/WP3_Code_README.md)
### Linking LiDAR to biodiversity
Here, we collate biodiversity surveys from past Forest Research projects into a larger database. The back-bone of these data is the [WrEN project](https://www.wren-project.com/) which surveyed ~ 1000 broadleaved forests across England and Scotland for a range of taxanomic groups. However this project could only use the English WrEN data as this is what the NLP is limited to, as such the WrEN data are supplemented by other similar projects to increase sample sizes. All surveys included field-based structural measurements which were subsequently shown to explain variation in biodiversity. We focuson three taxanomic groups as these were well surveyed across all study sites: understory plants, ground-crawling invertebrates (spiders and beetles), and flying invertebrates (hoverflies and craneflies). 

Our testing framework builds on past work from the WrEN project which identified the field-derived structural metrics that impact different taxanomic groups - although this was a small part of the wider project. For each biodiversity response we construct three models: one with field-derived structural metrics, one with LiDAR derived structural metrics, and one with both. We then use Akaike's information criterion (AIC) to select the best model. If LiDAR only models are equally as good as models with field-derived metrics then the LiDAR only models are chosen. For understory plants our responses are total ecies richness, the species richness of woodland associated ground flora, and the species richness of woodland specialist ground flora. For ground crawling and flying invertebrates our responses are species richness, the effective number of species (hill number q = 1), and abundance. 

The LiDAR metrics we extract are Foliage Height diversity (FHD) defined as the effective number of foliage layers, gap fraction (the proportion of a forest comprised of canopy gaps), and stem density. For the FHD metric our layers are defined as 0-1-2-5-8-20 meters. For the gap fraction metric, gaps are defined as any 10 m contiguous area where the foliage is below 2 m in height. FHD is calculated after removing gaps from each forest so as to make the metrics fully independent.
